# 05 – Firebase integration: issues & fixes (Flutter, iOS/macOS)

## Firebase CLI couldn’t list/create projects

**Symptom:** `Failed to fetch your Firebase projects` / `Failed to create project`.

**Fix:** Update & reauth, then use a globally unique project ID.

```bash
npm i -g firebase-tools
dart pub global activate flutterfire_cli
firebase logout && firebase login --reauth
# optional variable
export NEW_ID="flash-chat-flutter-2025-<unique>"
firebase projects:create "$NEW_ID"
firebase use "$NEW_ID"
```

## Project ID variable (NEW\_ID)

`NEW_ID` is just a shell variable. Either set it once and reuse it, or pass the ID directly to commands. The ID must be unique worldwide.

## `flutterfire configure`: Ruby/Xcode gem error

**Symptom:** `cannot load such file -- xcodeproj (LoadError)`.

**Fix:** Ensure Xcode CLTs, CocoaPods, and the `xcodeproj` gem for the Ruby on your PATH.

```bash
xcode-select --install || true
brew install cocoapods
pod --version
# install the gem for Homebrew’s Ruby
$(brew --prefix ruby)/bin/gem install xcodeproj
```

## Missing `firebase_core` in app

**Symptom:** In `firebase_options.dart`: `Target of URI doesn't exist: 'package:firebase_core/firebase_core.dart'`.

**Fix:** Add the package and initialize in `main.dart`.

```bash
flutter pub add firebase_core
```

```dart
await Firebase.initializeApp(
  options: DefaultFirebaseOptions.currentPlatform,
);
```

## iOS deployment target too low

**Symptom:** Pods resolve error like `cloud_firestore ... requires a higher minimum iOS deployment version` (auto-assigned iOS 13.0).

**Fix:** Set iOS 15.0 everywhere, then reinstall pods.

* **`ios/Podfile`** (near top, uncommented):

  ```ruby
  platform :ios, '15.0'
  ```
* **Force in `post_install`** (inside existing block):

  ```ruby
  post_install do |installer|
    installer.pods_project.targets.each do |target|
      flutter_additional_ios_build_settings(target)
      target.build_configurations.each do |config|
        config.build_settings['IPHONEOS_DEPLOYMENT_TARGET'] = '15.0'
      end
    end
  end
  ```
* **`ios/Flutter/AppFrameworkInfo.plist`**:

  ```xml
  <key>MinimumOSVersion</key>
  <string>15.0</string>
  ```
* **Reinstall pods & rebuild**:

  ```bash
  rm -rf ios/Pods ios/Podfile.lock
  cd ios && pod repo update && pod install && cd ..
  flutter clean
  flutter run
  ```
* If needed, in **Xcode** set **Runner → iOS Deployment Target = 15.0** (project & target).

## CocoaPods base configuration warning

**Symptom:** “CocoaPods did not set the base configuration …”

**Fix:** Include Pods xcconfigs from Flutter xcconfigs.

* **`ios/Flutter/Debug.xcconfig`**

  ```xcconfig
  #include? "Pods/Target Support Files/Pods-Runner/Pods-Runner.debug.xcconfig"
  #include "Generated.xcconfig"
  ```
* **`ios/Flutter/Release.xcconfig`**

  ```xcconfig
  #include? "Pods/Target Support Files/Pods-Runner/Pods-Runner.release.xcconfig"
  #include "Generated.xcconfig"
  ```
* *(Optional)* **`ios/Flutter/Profile.xcconfig`**

  ```xcconfig
  #include? "Pods/Target Support Files/Pods-Runner/Pods-Runner.profile.xcconfig"
  #include "Generated.xcconfig"
  ```
* In **Xcode → Runner (target) → Build Settings → Base Configuration** point Debug/Release/Profile to the corresponding `ios/Flutter/*.xcconfig` files.

## Where to store Firebase App IDs/config

Keep **`lib/firebase_options.dart`** (generated by FlutterFire) **committed**. Don’t put IDs in `pubspec.yaml`. Legacy `GoogleService-Info.plist` / `google-services.json` are not needed with Dart-only init.

## Slow first build

\~400s initial iOS build after adding many pods is normal (first compile/index). Subsequent runs are much faster; hot reload is near‑instant.
